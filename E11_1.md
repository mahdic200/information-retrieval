# E11_1

## مفهوم Evaluating an IR system

برای ارزیابی یک سیستم بازیابی اطلاعات گفتیم که کاربر information need خودش رو ترجمه میکنه در قالب یک کوئری و این رو در اختیار یک موتور جست و جو قرار میده و موتور جست و جو هم درک و فهمی از نیاز اطلاعاتی کاربر نداره ، و فقط داره اون کوئری رو میبینه و بعد براساس این کوئری میره یک سری سند هارو بازیابی میکنه ، سند هایی که از نظر اون مطابقت داشته باشن با این کوئری . حالا این کوئری چقدر تونسته بیان بکنه این نیاز اطلاعاتی رو ، اون ی بحث دیگه ایی هست.
اتفاقا مشکل همینجا بوجود میاد ، وممکنه اون چیزی که میخواد رو به درستی بیان نکنه . حال اگر ما یک موتور جست و جویی داریم که داره براساس این کوئری ناقص یک سری نتیاج نامربوطی میده نمیتونیم بگیم بدرد نمیخوره ، یک عدم قطعیت بوجود میاد و اون عدم قطعیت ممکنه ناشی از اشتباه کاربر باشه .

حتی ممکنه تو ارزیابی مربوط بودن سند های بازیابی شده سلیقه و یا اشتباه انسانی دخیل باشه . نمیتونیم به راحتی پاسخ بدیم .

## مورد Standard relevance benchmarks

یک سری بنچ مارک وجود دارند که توسط موسسات معتبری تهیه شدند . معروف ترینش TREC هست و توی همشون متخصصین انسانی اومدن اینارو تگ زدند .

حالا زمانی که یک موتور جست و جو رو میارن و روی این داده های تگ گذاری شده ، این میشه یک مسئله ی خوشه بندی .

یک کانفیوژن ماتریکس میتونه ساخته بشه .

## مفهوم Unranked retrieval evaluation: Precision and Recall

مفهوم های :
- دقت یا Precision : بخشی از سند های بازیابی شده که مرتبط هستند
- ریکال یا Recall : بخشی از سند های بازیابی شده که بازیابی شده اند (مرتبط یا نامرتبط مطرح نیست ، فقط مهمه که از همه ی داده ها چند تارو بازیابی کرده)

به این میگن کانفیوژن ماتریکس


|               | Relevant | Non-Relevant |
| ------------- | -------- | ------------ |
| Retrieved     | TP       | FP           |
| Not Retrieved | FN       | TN           |

## مفهوم Precision

از کل داده ها و سند هایی که بازیابی کردی چند تا از اونها مرتبط بودند .

$$Precision = { {TP} \over {TP + FP} }$$
## مفهوم Recall

از کل داده ها و سند هایی که در پایگاه داده موجود بودند تو چند تارو بازیابی کردی .

$$Recall = { {TP} \over {TP + FN} }$$

## مفهوم Accuracy

بخش هایی از این خوشه بندی ها که درست هستند .


$$Accuracy = { {TP + TN} \over {TP + FP + FN + TN} }$$

## آیا Accuracy برای موتور های جست و جو معیار مناسبی است ؟

خیر . یک موتور جست و جوی فرضی رو در نظر بگیرید . یک عبارتی رو وارد میکنید ، هیچی به شما بر نمیگردونه . چرا ؟ چون TN توی کسر بالا بسیار تاثیر میزاره .

فرض کنید شما یک چیزی وارد میکنید ، صد هزار سند به عنوان مرتبط بازیابی میشه و فرض کنید که این صدهزار ها همشون نادرست بودن و نامرتبط ، چند تای این ها TN بودن ؟ میلیون ها میلیون ، و فرض کنید که TP شمام صفر باشه ، توی این کسر این TP بعلاوه ی TN میشه و تقسیم بر TN (اونقدر تعداد TN ها زیاده که میتونیم از بقیه ی عبارت های توی کسر صرف نظر کنیم) میشه ، اونوقت کسر شما تقریبا میشه یک .

بنابراین این Accuracy اصلا معیار مناسبی نیست .

## مفهوم های Precision/Recall

توی موتور های جست و جویی که روی وب کار میکنن Precision مهم تره ، چرا ؟ چون کاربر انتظار داره اون ۱۵ تا ۲۰ تا موردی که بهش نشون میدی تو صفحه ی اول معتبر و مرتبط باشه .

یا انتظار داره موتور جست و جو ظرافت بالاتری داشته باشه به نسبت درصد داده هایی که داره بازیابی میکنه .

> [!IMPORTANT] دقت مهم تره !
> توی موتور های جست و جو Precision به مراتب مهم تر از Recall هست .

دقت میگه از این نتایجی که برای من بازیابی کردی چندتاش مرتبطه . ریکال میگه از کل سند های مرتبط تو چند تارو برای من بازیابی کردی .

توی موتور های جست و جویی که برای سرویس های امنیت توسعه میدن ، که باید دنبال پرونده های یک سری مجرم و اینا بگردن ، خب ریکال مهم تره ، چون نباید سوابق مجرم ها از زیر دست پلیس اینترپل در بره . اینجا برای ما خیلی مهمه که مجرمه پیدا بشه ، حالا ممکنه وقت هم بگیره ، یک تیم خیلی بزرگ هم بررسی بکنه . مهم اینه اون نتیجهه که میخوان داخل داده ها بشه.

ولی توی Precision کاربر میخواد سریع به نتیجه برسه ، وقت نداره یک ساعت بگرده توی سند هایی که براش بازیابی کردی . توی صفحه ی اول نباشه کوئری رو عوض میکنه .

بنابراین بسته به دامنه ایی که شما میخواین براش موتور جست و جو طراحی بکنید ، Precision یا Recall میتونن اهمیت گوناگونی داشته باشن . ولی معمولا Precision مهم تر هست .

## رابطه ی میانی Precision و Recall

هنگامی که تعداد سند هایی که میخواین بازیابی کنید افزایش پیدا میکنه ، یعنی ی موتور جست و جو به جای اینکه صد تا سند بازیابی بکنه ، هزار تا بازیابی بکنه ، هرچقدر تعداد سند هایی که میخواد بازیابی بکنه افزایش پیدا بکنه . Recall احتمالا افزایش میباید .

ریکال می توان گفت تابعی غیر نزولی از تعداد سند هاییه که بازیابی میشه . هرچقدر تعداد سند هایی که بازیابی میشه بالاتر بره ، ریکال هم ***کم نخواهد شد*** ، ***میتونه افزایش هم پیدا بکنه*** .

دقت چی میشه ؟ Precision معمولا تو کاربرد های عملی نشون دادن (اثبات نمیشه کرد) ، که معمولا وقتی که Recall افزایش پیدا میکنه Precision کاهش پیدا میکنه .
هرچقدر تعداد سند هایی میخوای بازیابی بکنی افزایش پیدا میکنه ، درسته که Recall میره بالاتر ، وقتی که تعداد سند های بازیابی شده رو بالاتر میبری ، ولی از اونور Precision ممکنه که پایین بیاد و کاهش پیدا بکنه .

یک موتور جست و جو رو در نظر بگیرید ، ممکنه ده تا سند برای شما بازیابی بکنه ، و هرده تاش مربوط باشه ، Recall ممکنه اصلا صفر باشه ، ولی دقت صده .

ولی موتور جست و جویی رو در نظر بگیرید که ۱۰۰ تا سند رو برای شما بازیابی بکنه ، ولی توی اون صد تا ۱۱ تا مربوط هست ، بقیه نیستند .

ترتیب مهمه ، حتی Rank هم بسیار مهمه .


- شما میتونید ریکال بالایی بگیرید (ولی دقت بسیار پایینی بگیرید !) با بازیابی کردن تمامی سند های توی پایگاه داده برای تمامی کوئری ها !

## شاخص ترکیبی F

حالا دوتا موتور جست و جو ممکنه وجود داشته باشن ، تو یکیش دقت مهمه تو یکی ریکال مهمه . میتونیم هم تو بعضی از کاربرد ها وزن بدیم . یعنی میگیم فقط دقت رو در نظر نگیر ریکال هم مهم ، ولی دقت چند برابر ریکال برای من مهم . وزن دهی میتونیم بکنیم .

فرمولش هم به صورت میانگین هارمونیک هست .
#### $$F= { {1} \over { \alpha {1 \over P} + (1-\alpha) { 1 \over R } } } = { {(B^2 + 1)PR} \over {B^2P + R} } $$

> [!IMPORTANT] محافظ کارانه
> میگن میانگین هارمونیک یک میانگین محافظه کارانه است ، یعنی اینکه شما اگر دو تا عدد داشته باشید و بخواید میانگین بگیرین ، میانگین به سمت عدد کوچک تر میل میکنه . بخاطر همین بهش میگیم محافظه کارانه .

یعنی اگر ما Precision و Recall داشته باشیم ، که یک کدوم پایین باشه ، میانگین هارمونیک به سمت کمینه میل میکنه .
در صورتی شاخص F بالا خواهد بود که جفت دقت و ریکال بالا باشند ، نه اینکه یکی خیلی کم باشه یکی خیلی زیاد .
